library(rpart) 
library(rpart.plot) 
library(e1071) 
library(caret) 
library(ggplot2) 
library(pROC) 
data <- read.csv("C://Users//Sandhya Vishwakarma//OneDrive//Desktop//bank-loan.csv")  
head(data) 
data$default <- as.factor(data$default) 
str(data) 
set.seed(42) 
splitindex <- createDataPartition(data$default, p = 0.8, list = FALSE) 
train_data <- data[splitindex, ] 
test_data <- data[-splitindex, ] 
table(train_data$default) 
table(test_data$default) 
dt_model <- rpart(default ~ ., data=train_data, method = "class")
print(dt_model) 
png("Decision tree.jpeg", width=1300, height = 968) 
rpart.plot(dt_model, main="Decision tree chart") 
dev.off() 
dt_prob <- predict(dt_model, test_data, type="prob") 
dt_pred <- ifelse(dt_prob[,2] > 0.5, 1, 0) 
df_pred <- factor(dt_pred, levels = levels(test_data$default))
dt_conf_matrix <- confusionMatrix(df_pred, test_data$default)
print(dt_conf_matrix)

